import{_ as v,o as i,c as l,a as t,t as a,f as I,v as M,g as V,r as p,F as h,e as L,b as u,w as E,h as m,d as g}from"./index-095202d5.js";import{M as x}from"./bootstrap.esm-434bcbc7.js";import{P as T}from"./Pagination-c2161e69.js";const{VITE__URL:$,VITE__PATH:U}={VITE__PATH:"ken100",VITE__URL:"https://vue3-course-api.hexschool.io/v2",BASE_URL:"/hexschool-vue-dashboard",MODE:"production",DEV:!1,PROD:!0},S={data(){return{modal:{},tempContent:{imagesUrl:[]},qty:1}},props:{id:{type:String,default:""},addCart:{type:Function,default(){}},openModal:{type:Function,default(){}}},methods:{closeModal(){this.modal.hide()}},watch:{id(){this.id&&this.$http.get(`${$}/api/${U}/product/${this.id}`).then(n=>{this.tempContent=n.data.product,this.modal.show()}).catch(n=>{alert(`${n.response.data.message}`)})}},mounted(){this.$refs.modal.addEventListener("hidden.bs.modal",()=>{this.qty=1,this.openModal("")}),this.modal=new x(this.$refs.modal,{backdrop:"static",keyboard:!1})}},w={class:"modal fade",ref:"modal"},R={class:"modal-dialog modal-xl",role:"document"},D={class:"modal-content border-0"},A={class:"modal-header bg-dark text-white"},q={class:"modal-title",id:"exampleModalLabel"},B={class:"modal-body"},H={class:"row"},N={class:"col-sm-6"},F=["src"],O={key:1,class:"img-fluid",src:"https://placehold.co/640x480?text=No+Photo",alt:""},j={class:"col-sm-6"},z={class:"badge bg-primary rounded-pill"},G={class:"h5"},J={class:"h6"},K={class:"h5"},Q={class:"input-group"};function W(n,e,c,_,o,d){return i(),l("div",w,[t("div",R,[t("div",D,[t("div",A,[t("h5",q,[t("span",null,a(o.tempContent.title),1)]),t("button",{type:"button",class:"btn-close","aria-label":"Close",onClick:e[0]||(e[0]=(...r)=>d.closeModal&&d.closeModal(...r))})]),t("div",B,[t("div",H,[t("div",N,[o.tempContent.imageUrl?(i(),l("img",{key:0,class:"img-fluid",src:o.tempContent.imageUrl,alt:""},null,8,F)):(i(),l("img",O))]),t("div",j,[t("span",z,a(o.tempContent.category),1),t("p",null,"商品描述："+a(o.tempContent.description),1),t("p",null,"商品內容："+a(o.tempContent.content),1),t("div",G,a(o.tempContent.price)+" 元",1),t("del",J,"原價 "+a(o.tempContent.origin_price)+" 元",1),t("div",K,"現在只要 "+a(o.tempContent.price)+" 元",1),t("div",null,[t("div",Q,[I(t("input",{type:"number",class:"form-control",min:"1","onUpdate:modelValue":e[1]||(e[1]=r=>o.qty=r)},null,512),[[M,o.qty,void 0,{number:!0}]]),t("button",{type:"button",class:"btn btn-primary",onClick:e[2]||(e[2]=r=>c.addCart(o.tempContent,o.qty))}," 加入購物車 ")])])])])])])])],512)}const X=v(S,[["render",W]]),{VITE__URL:b,VITE__PATH:f}={VITE__PATH:"ken100",VITE__URL:"https://vue3-course-api.hexschool.io/v2",BASE_URL:"/hexschool-vue-dashboard",MODE:"production",DEV:!1,PROD:!0},Y={data(){return{isLoading:!1,loadingStatus:{loadingItem:""},products:[],pagination:{},tempProduct:{imagesUrl:[]},productId:""}},components:{RouterLink:V,ProductModal:X,Pagination:T},methods:{openModal(n){this.loadingStatus.loadingItem=n,this.productId=n},addCart(n,e=1){this.loadingStatus.loadingItem=n.id,this.$http.post(`${b}/api/${f}/cart`,{data:{product_id:n.id,qty:e}}).then(c=>{this.loadingStatus.loadingItem="";const{message:_,data:{product:o}}=c.data;alert(`${o.title} ${_}`),this.$refs.productModal.closeModal()}).catch(c=>{alert(`${c.response.data.message}`)})},getProducts(n=1){this.$http.get(`${b}/api/${f}/products?page=${n}`).then(e=>{this.products=e.data.products,this.pagination=e.data.pagination,this.isLoading=!1}).catch(e=>{alert(`${e.response.data.message}`)})}},mounted(){this.isLoading=!0,this.getProducts()}},Z=t("h1",null,"Product list",-1),tt={class:"row"},ot={class:"card mb-4"},et=["src","alt"],st={class:"card-body"},nt={class:"badge rounded-pill bg-primary"},at={class:"card-title"},dt={class:"card-text"},it={class:"btn-group btn-group-sm"},lt=["onClick","disabled"],ct={key:0,class:"fas fa-spinner fa-pulse"},rt=["onClick","disabled"],pt={key:0,class:"fas fa-spinner fa-pulse"};function ut(n,e,c,_,o,d){const r=p("router-link"),C=p("ProductModal"),y=p("Pagination"),P=p("VueLoading");return i(),l(h,null,[Z,t("div",tt,[(i(!0),l(h,null,L(o.products,s=>(i(),l("div",{class:"col-4",key:s.id},[t("div",ot,[u(r,{to:`/product/${s.id}`},{default:E(()=>[t("img",{src:s.imageUrl,class:"card-img-top",alt:s.title},null,8,et)]),_:2},1032,["to"]),t("div",st,[t("span",nt,a(s.category),1),t("h5",at,a(s.title),1),t("p",dt,a(s.description),1),t("div",it,[t("button",{type:"button",class:"btn btn-outline-secondary",onClick:k=>d.openModal(s.id),disabled:o.loadingStatus.loadingItem===s.id},[o.loadingStatus.loadingItem===s.id?(i(),l("i",ct)):m("",!0),g(" 快速查看 ")],8,lt),t("button",{type:"button",class:"btn btn-outline-danger",onClick:k=>d.addCart(s),disabled:o.loadingStatus.loadingItem===s.id},[o.loadingStatus.loadingItem===s.id?(i(),l("i",pt)):m("",!0),g(" 加到購物車 ")],8,rt)])])])]))),128))]),u(C,{ref:"productModal","temp-content":o.tempProduct,"add-cart":d.addCart,id:o.productId,"open-modal":d.openModal},null,8,["temp-content","add-cart","id","open-modal"]),u(y,{pages:o.pagination,onChangePage:d.getProducts,"get-data":d.getProducts},null,8,["pages","onChangePage","get-data"]),u(P,{active:o.isLoading,"onUpdate:active":e[0]||(e[0]=s=>o.isLoading=s)},null,8,["active"])],64)}const gt=v(Y,[["render",ut]]);export{gt as default};
